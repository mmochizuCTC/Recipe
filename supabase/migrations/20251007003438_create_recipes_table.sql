/*
  # レシピテーブルの作成

  1. 新しいテーブル
    - `recipes`
      - `id` (uuid, primary key)
      - `name` (text) - 料理名
      - `genre` (text) - ジャンル（和食、洋食、中華）
      - `category` (text) - カテゴリ（主菜、副菜、汁物）
      - `ingredients` (text[]) - 必要な食材リスト
      - `steps` (text) - 調理手順
      - `created_at` (timestamptz)
      
  2. セキュリティ
    - RLSを有効化
    - 誰でも読み取り可能なポリシーを追加
*/

CREATE TABLE IF NOT EXISTS recipes (
  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
  name text NOT NULL,
  genre text NOT NULL,
  category text NOT NULL,
  ingredients text[] NOT NULL,
  steps text NOT NULL,
  created_at timestamptz DEFAULT now()
);

ALTER TABLE recipes ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Anyone can read recipes"
  ON recipes
  FOR SELECT
  TO authenticated, anon
  USING (true);

-- サンプルデータの挿入
INSERT INTO recipes (name, genre, category, ingredients, steps) VALUES
  ('肉じゃが', '和食', '主菜', ARRAY['じゃがいも', '豚肉', '玉ねぎ', '人参', '醤油', '砂糖'], '1. じゃがいも、人参を一口大に切る。2. 鍋で豚肉を炒め、野菜を加える。3. 水、醤油、砂糖を加えて煮込む。'),
  ('味噌汁', '和食', '汁物', ARRAY['豆腐', 'わかめ', '味噌', 'だし'], '1. だしを沸かす。2. 豆腐を加える。3. 味噌を溶いて完成。'),
  ('ほうれん草のおひたし', '和食', '副菜', ARRAY['ほうれん草', '醤油', 'かつお節'], '1. ほうれん草を茹でる。2. 水気を切り、醤油をかける。3. かつお節をのせる。'),
  ('ハンバーグ', '洋食', '主菜', ARRAY['牛肉', '豚肉', '玉ねぎ', 'パン粉', '卵'], '1. 材料を混ぜ合わせる。2. 形を整える。3. フライパンで焼く。'),
  ('コーンスープ', '洋食', '汁物', ARRAY['コーン', '牛乳', 'バター', '塩', 'こしょう'], '1. コーンをミキサーにかける。2. 鍋で牛乳と煮る。3. バター、塩、こしょうで味を調える。'),
  ('シーザーサラダ', '洋食', '副菜', ARRAY['レタス', 'チーズ', 'クルトン', 'ドレッシング'], '1. レタスを洗って切る。2. チーズとクルトンを加える。3. ドレッシングをかける。'),
  ('麻婆豆腐', '中華', '主菜', ARRAY['豆腐', '豚肉', '長ねぎ', '豆板醤', '醤油'], '1. 豆腐を切る。2. 豚肉を炒める。3. 調味料を加えて煮込む。'),
  ('中華スープ', '中華', '汁物', ARRAY['卵', 'わかめ', '鶏がらスープ', 'ごま油'], '1. スープを沸かす。2. 溶き卵を流し入れる。3. わかめとごま油を加える。'),
  ('春雨サラダ', '中華', '副菜', ARRAY['春雨', 'きゅうり', 'ハム', '酢', '醤油'], '1. 春雨を戻す。2. きゅうり、ハムを切る。3. 調味料で和える。'),
  ('鶏の照り焼き', '和食', '主菜', ARRAY['鶏肉', '醤油', 'みりん', '砂糖'], '1. 鶏肉に切り込みを入れる。2. フライパンで焼く。3. 調味料を加えて照りを出す。'),
  ('カルボナーラ', '洋食', '主菜', ARRAY['パスタ', 'ベーコン', '卵', 'チーズ', '牛乳'], '1. パスタを茹でる。2. ベーコンを炒める。3. 卵、チーズ、牛乳を混ぜてソースを作り和える。'),
  ('エビチリ', '中華', '主菜', ARRAY['エビ', 'ケチャップ', '豆板醤', '長ねぎ', '生姜'], '1. エビの下処理をする。2. 調味料を合わせる。3. エビを炒めて調味料を絡める。')
ON CONFLICT DO NOTHING;